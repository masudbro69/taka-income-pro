<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz - Taka Income Pro</title>
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore-compat.js"></script>
</head>
<body>
  <div class="container">
    <h2>আজকের কুইজ</h2>
    <div id="quiz-box">
      <p id="question"></p>
      <div id="options"></div>
      <button id="next-btn" disabled>পরবর্তী প্রশ্ন</button>
      <p id="result"></p>
    </div>
    <audio id="correct-sound" src="assets/correct.mp3" preload="auto"></audio>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAOlGcQIMpp_ItYWRmAA0jFZKNKM1eNgOY",
      authDomain: "taka-income-pro.firebaseapp.com",
      projectId: "taka-income-pro",
      storageBucket: "taka-income-pro.appspot.com",
      messagingSenderId: "213383940361",
      appId: "1:213383940361:web:cf958d4b17654d42cfd2d8"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const questions = [
      {
        question: "বাংলাদেশের রাজধানী কোথায়?",
        options: ["চট্টগ্রাম", "ঢাকা", "খুলনা", "রাজশাহী"],
        answer: "ঢাকা"
      },
      {
        question: "স্বাধীনতা দিবস কবে?",
        options: ["২৬ মার্চ", "২১ ফেব্রুয়ারি", "১৬ ডিসেম্বর", "১ জানুয়ারি"],
        answer: "২৬ মার্চ"
      },
      {
        question: "বাংলাদেশের জাতীয় ফুল কী?",
        options: ["গোলাপ", "শাপলা", "সুর্যমুখী", "জুঁই"],
        answer: "শাপলা"
      }
    ];

    let current = 0;
    let coins = 0;
    let currentUID = null;

    const qEl = document.getElementById("question");
    const optEl = document.getElementById("options");
    const resEl = document.getElementById("result");
    const nextBtn = document.getElementById("next-btn");
    const sound = document.getElementById("correct-sound");

    function showQuestion() {
      const q = questions[current];
      qEl.textContent = q.question;
      optEl.innerHTML = "";
      nextBtn.disabled = true;
      resEl.textContent = "";

      q.options.forEach(opt => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(opt);
        optEl.appendChild(btn);
      });
    }

    function checkAnswer(selected) {
      const correct = questions[current].answer;
      if (selected === correct) {
        resEl.textContent = "সঠিক উত্তর! +10 কয়েন";
        coins += 10;
        sound.play();
        nextBtn.disabled = false;
      } else {
        resEl.textContent = "ভুল উত্তর!";
        nextBtn.disabled = false;
      }
    }

    nextBtn.onclick = () => {
      current++;
      if (current < questions.length) {
        showQuestion();
      } else {
        saveCoins();
        qEl.textContent = "ধন্যবাদ! আপনি সব প্রশ্নের উত্তর দিয়েছেন।";
        optEl.innerHTML = "";
        nextBtn.style.display = "none";
      }
    };

    function saveCoins() {
      if (currentUID) {
        const userRef = db.collection("users").doc(currentUID);
        userRef.get().then(doc => {
          const previous = doc.data().coins || 0;
          userRef.update({ coins: previous + coins });
        });
      }
    }

    auth.onAuthStateChanged(user => {
      if (user) {
        currentUID = user.uid;
        showQuestion();
      } else {
        auth.signInAnonymously();
      }
    });
  </script>
</body>
</html>
