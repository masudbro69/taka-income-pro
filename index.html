<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Taka Income Pro</title>
</head>
<body>
  <!-- Page Title -->
  <h1>Welcome to Taka Income Pro</h1>

  <!-- Coin Display -->
  <p>Coins: <span id="coinSpan">0</span></p>

  <!-- Sound effect when coin updates -->
  <audio id="coinSound" src="coin.mp3" preload="auto"></audio>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // === Firebase Configuration (Replace with your own later) ===
    const firebaseConfig = {
      apiKey: "AIzaSyDw8b4YO-YkY-JJq3MZssVzIiv-Y1wVwXQ",
      authDomain: "taka-income-demo.firebaseapp.com",
      projectId: "taka-income-demo",
      storageBucket: "taka-income-demo.appspot.com",
      messagingSenderId: "1234567890",
      appId: "1:1234567890:web:abcd1234efgh5678"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // Shortcuts
    const auth = firebase.auth();
    const db = firebase.firestore();

    // DOM Elements
    const coinSpan = document.getElementById("coinSpan");
    const sound = document.getElementById("coinSound");

    // Auth State Observer
    auth.onAuthStateChanged(async user => {
      if (user) {
        const userRef = db.collection("users").doc(user.uid);
        const doc = await userRef.get();

        // If user doesn't exist, create with 0 coins
        if (!doc.exists) {
          await userRef.set({ coins: 0 });
        }

        // Realtime listener for coin updates
        userRef.onSnapshot((doc) => {
          const coins = doc.data().coins;
          coinSpan.innerText = coins;
          sound.play(); // Play sound on update
        });

      } else {
        // Anonymous Sign In
        auth.signInAnonymously();
      }
    });
  </script>

  <!-- Adsterra Social Bar Ad -->
  <script type="text/javascript" src="//pl26430918.profitableratecpm.com/eb/fc/e4/ebfce4c207953537986201bbf50217d3.js"></script>
</body>
</html>
